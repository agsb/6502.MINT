# 6502.MINT

A still raw [Mint](https://github.com/monsonite/MINT) for 6502.

_this still a stub_

## Notes

_20/10/2023_

A 6502 is a 8-bit CPU doing 16-bit things, then better safe than sorry, tweak if need more speed.

      a Z80, does 16-bit add (ADD HL, DE) in 12 cycles and use 1 byte  
      a 6502, does a 16-bit add it in 13 cycles and uses 9 bytes 

the MINT stacks are at fixed address, do not use of hardware stack, leave it free.

No plans for multi-task or multi-user or garbage collector or flush flash eeproms. 

### Code Design

   - this code is for ROM use. 
   - if change for RAM, caller must save A, X, Y and reserve at least 16 words at hardware stack 
   - a cell is 16-bit 
   - stacks are round-robin using absolute address and grows backwards
   - data stack indexed by X and return stack indexed by Y 
   - terminal input buffer and stacks are all just 128 cells deep 
   - extense use of Y indexed indirect addressing and absolute offsets by X and Y 
   - uses 16 bytes at page zero $F0 to $FF.
   - user macros are stored in heap
   - all macros, inputs and outputs are limited to 255 bytes.
   - MINT called functions are ended with \_
   - all routines must end with: jmp _next_ or jmp _(vNext)_ or jmp _drop__ 
   - all stack routines, load the index at start and save the index at end, if changed.
   - this leaves free SP, X and Y for general use.
      
### MINT Changes

1. Depends on external BIOS for:
      - _hitc_, check if a key pressed,
      - _getc_, wait and receive a byte,
      - _putc_, wait and transmit a byte
      - _tick_, counts clock ticks, *not yet*

2. Expanded mint variables
      - _alt-a_, used for vS0, start of data stack, *hardcoded*
      - _alt-f_, used for vR0, start of return stack  *hardcoded*
      - _alt-g_, used for vNext, indirect dispatcher  
      - _alt-r_, return the return stack pointer
      - _alt-s_, return the data stack pointer

3. Expanded mint functions:
      - _alt-U_, classic Forth R> 
      - _alt-V_, classic Forth >R 
      - _alt-H_, verify if a key was hit 
      - _alt-*_, multiplication 16x16 leaves a reminder of product by 65536 and a quotient of product by 65536
      - _alt-/_, division 16x16 leaves a reminder by divisor and a quotient by divisor

      the _*_ multiplication and _/_ division, uses _alt-*_ and _alt-/_, and drops.
   
5. All variables and user macros are composed in groups,
      - Each group have 32 cells, 26 are accessed from 'a' to 'z', and last 6 cells below 'z'.
      - User macros extended for 5 groups  

6. Extra string functions, both ends at crlf or asciiz:
      - _gets\__, gets a line into a buffer, 
      - _puts\__, puts a line from a buffer,  

7. FALSE is _0x00_ and TRUE is non FALSE, maybe 0x01 to 0xFF.
      - Why? Easy Zero flag test, beq is FALSE, bne is TRUE.

8. Loops counts from 1 till 65535.
      - and begin tha flame wars...


    
